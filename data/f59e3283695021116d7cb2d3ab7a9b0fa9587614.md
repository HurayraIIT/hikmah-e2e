# Test info

- Name: Public Home Page >> hikmah public home - single post
- Location: /home/runner/work/hikmah-e2e/hikmah-e2e/tests/public-home.spec.ts:83:3

# Error details

```
Error: Timed out 5000ms waiting for expect(locator).toMatchAriaSnapshot(expected)

Locator: getByRole('article')
- Expected  - 16
+ Received  + 25

- - link "Abu Hurayra":
+ - article:
+   - link "Abu Hurayra":
-   - img "Abu Hurayra"
+     - /url: /@hurayraiit
+     - img "Abu Hurayra"
- - link "Abu Hurayra"
- - button "Follow"
+   - link "Abu Hurayra":
+     - /url: /@hurayraiit
+   - button "Follow"
- - link /ago/
- - paragraph: Eid Mubarak
+   - link "1 month ago":
+     - /url: /post/eid-mubarak-8p81l8hDNZ
+   - img
+   - paragraph: Eid Mubarak
- - img
+   - img
- - text: /\d+ views/
+   - text: 2 109 views
- - button "React":
+   - button "Like":
-   - img
+     - img
- - button "Comment":
+     - text: Like
+   - button "Comment":
-   - img
+     - img
- - button "Share":
+     - text: Comment
+   - button "Share":
-   - img
+     - img
- - button "Save":
+     - text: Share
+   - button "Save":
-   - img
+     - img
+     - text: Save
Call log:
  - expect.toMatchAriaSnapshot with timeout 5000ms
  - waiting for getByRole('article')
    9 × locator resolved to <article class="flex-1">…</article>
      - unexpected value "- article:
  - link "Abu Hurayra":
    - /url: /@hurayraiit
    - img "Abu Hurayra"
  - link "Abu Hurayra":
    - /url: /@hurayraiit
  - button "Follow"
  - link "1 month ago":
    - /url: /post/eid-mubarak-8p81l8hDNZ
  - img
  - paragraph: Eid Mubarak
  - img
  - text: 2 109 views
  - button "Like":
    - img
    - text: Like
  - button "Comment":
    - img
    - text: Comment
  - button "Share":
    - img
    - text: Share
  - button "Save":
    - img
    - text: Save"

    at /home/runner/work/hikmah-e2e/hikmah-e2e/tests/public-home.spec.ts:90:45
```

# Page snapshot

```yaml
- link:
  - /url: javascript:void(0)
  - img
- button "Login"
- link "Abu Hurayra":
  - /url: /@hurayraiit
  - img "Abu Hurayra"
- link "Abu Hurayra":
  - /url: /@hurayraiit
- link "@hurayraiit":
  - /url: /@hurayraiit
- paragraph: Follower
- article:
  - link "Abu Hurayra":
    - /url: /@hurayraiit
    - img "Abu Hurayra"
  - link "Abu Hurayra":
    - /url: /@hurayraiit
  - button "Follow"
  - link "1 month ago":
    - /url: /post/eid-mubarak-8p81l8hDNZ
  - img
  - paragraph: Eid Mubarak
  - img
  - text: 2 109 views
  - button "Like":
    - img
    - text: Like
  - button "Comment":
    - img
    - text: Comment
  - button "Share":
    - img
    - text: Share
  - button "Save":
    - img
    - text: Save
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test';
   2 |
   3 | test.describe("Public Home Page", () => {
   4 |   test("hikmah public home - right column", async ({ page }) => {
   5 |     // Navigate to the home page
   6 |     await page.goto('/');
   7 |     await page.waitForLoadState('domcontentloaded');
   8 |     const continueButton = page.getByRole('button', { name: 'Continue browsing' });
   9 |
   10 |     // Verify the sign in card contents
   11 |     await expect(page.locator('section')).toMatchAriaSnapshot(`
   12 |     - link:
   13 |       - img
   14 |     - heading "Let’s have a decent conversation" [level=6]
   15 |     - heading "Sign In" [level=1]
   16 |     - paragraph: Welcome to Hikmah
   17 |     - link "Sign in"
   18 |     - text: /Copyright 2025 by Hikmah — A Kahf Software Initiative/
   19 |     - link "Support"
   20 |     - link "Privacy Policy"
   21 |     - link "Terms & Conditions"
   22 |     `);
   23 |     await expect(page.getByRole('heading', { name: 'Let’s have a decent conversation' })).toBeVisible();
   24 |     await expect(page.getByRole('heading', { name: 'Sign In' })).toBeVisible();
   25 |     await expect(page.getByText('Welcome to Hikmah')).toBeVisible();
   26 |     await expect(page.getByRole('link', { name: 'Sign in' })).toBeVisible();
   27 |
   28 |     // Verify the footer contents
   29 |     await expect(page.getByText('Copyright 2025 by Hikmah — A Kahf Software Initiative')).toBeVisible();
   30 |     await expect(page.getByRole('link', { name: 'Support' })).toHaveAttribute('href', /support/);
   31 |     await expect(page.getByRole('link', { name: 'Privacy Policy' })).toHaveAttribute('href', /privacy-policy/);
   32 |     await expect(page.getByRole('link', { name: 'Terms & Conditions' })).toHaveAttribute('href', /terms-and-conditions/);
   33 |
   34 |     // Verify the sign in button click
   35 |     await page.getByRole('link', { name: 'Sign in' }).click();
   36 |     await page.waitForTimeout(1000);
   37 |     await expect(page).toHaveURL("https://id.kahf.co/?returnUrl=https%3A%2F%2Fhikmah.net%2Fauth%2Fkahf");
   38 |     await expect(page.getByRole('heading', { name: 'Sign in to your account' })).toBeVisible();
   39 |   });
   40 |
   41 |   test("hikmah public home - login dialog", async ({ page }) => {
   42 |     // View a public post through the share link
   43 |     await page.goto(`${process.env.BASE_URL}`);
   44 |     await page.waitForLoadState('domcontentloaded');
   45 |     const continueButton = page.getByRole('button', { name: 'Continue browsing' });
   46 |     await page.waitForTimeout(3000);
   47 |
   48 |     // Card items
   49 |     await page.getByRole('button', { name: "Follow" }).nth(0).click();
   50 |     await continueButton.click();
   51 |     await page.locator('div.feed-main-action button').nth(0).click();
   52 |     await continueButton.click();
   53 |     await page.locator('div.feed-main-action button').nth(1).click();
   54 |     await continueButton.click();
   55 |     await page.locator('div.feed-main-action button').nth(2).click();
   56 |     await continueButton.click();
   57 |     await page.locator('div.feed-main-action button').nth(3).click();
   58 |     await continueButton.click();
   59 |
   60 |     // Scrolling should trigger the login popup
   61 |     for (let i = 0; i < 6; i++) {
   62 |       await page.waitForTimeout(500);
   63 |       await page.locator('div.feed-item').nth(i).scrollIntoViewIfNeeded();
   64 |     }
   65 |
   66 |     // Verify the login popup
   67 |     await expect(page.locator('body')).toMatchAriaSnapshot(`
   68 |     - heading "Sign in to see more" [level=3]
   69 |     - paragraph: Join our community to access all features
   70 |     - link "Sign in"
   71 |     - button "Continue browsing"
   72 |     `);
   73 |     await expect(page.getByRole('heading', { name: 'Sign in to see more' })).toBeVisible();
   74 |     await expect(page.getByText('Join our community to access all features')).toBeVisible();
   75 |     await expect(page.getByRole('dialog').filter({ hasText: 'Sign in to see moreJoin our' }).getByRole('link')).toHaveAttribute("href", "https://hikmah.net/auth/kahf");
   76 |     await expect(continueButton).toBeVisible();
   77 |
   78 |     await continueButton.click();
   79 |     await page.waitForTimeout(500);
   80 |     await expect(page.getByRole('heading', { name: 'Sign in to see more' })).not.toBeVisible();
   81 |   });
   82 |
   83 |   test("hikmah public home - single post", async ({ page }) => {
   84 |     // View a public post through the share link
   85 |     await page.goto("https://hikmah.net/post/eid-mubarak-8p81l8hDNZ");
   86 |     await page.waitForLoadState('domcontentloaded');
   87 |     const continueButton = page.getByRole('button', { name: 'Continue browsing' });
   88 |
   89 |     await expect(page.locator('div').filter({ hasText: /^Login$/ })).toBeVisible();
>  90 |     await expect(page.getByRole('article')).toMatchAriaSnapshot(`
      |                                             ^ Error: Timed out 5000ms waiting for expect(locator).toMatchAriaSnapshot(expected)
   91 |       - link "Abu Hurayra":
   92 |         - img "Abu Hurayra"
   93 |       - link "Abu Hurayra"
   94 |       - button "Follow"
   95 |       - link /ago/
   96 |       - paragraph: Eid Mubarak
   97 |       - img
   98 |       - text: /\\d+ views/
   99 |       - button "React":
  100 |         - img
  101 |       - button "Comment":
  102 |         - img
  103 |       - button "Share":
  104 |         - img
  105 |       - button "Save":
  106 |         - img
  107 |       `);
  108 |     await expect(page.locator('#center')).toMatchAriaSnapshot(`
  109 |     - link "Abu Hurayra":
  110 |       - img "Abu Hurayra"
  111 |     - link "Abu Hurayra"
  112 |     - link "@hurayraiit"
  113 |     - paragraph: Follower
  114 |     `);
  115 |
  116 |     await page.getByRole('button', { name: 'Login' }).click();
  117 |     await continueButton.click();
  118 |     await page.getByRole('button', { name: 'Follow' }).click();
  119 |     await continueButton.click();
  120 |     await page.getByRole('button', { name: 'React' }).click();
  121 |     await continueButton.click();
  122 |     await page.getByRole('button', { name: 'Comment' }).click();
  123 |     await continueButton.click();
  124 |     await page.getByRole('button', { name: 'Share' }).click();
  125 |     await continueButton.click();
  126 |     await page.getByRole('button', { name: 'Save' }).click();
  127 |     await continueButton.click();
  128 |
  129 |     // Back to home
  130 |     await page.locator('div').filter({ hasText: /^Login$/ }).getByRole('link').click();
  131 |     await expect(page.getByText('Welcome to Hikmah')).toBeVisible();
  132 |   });
  133 |
  134 |   test("hikmah public home - infinite scrolling", async ({ page }) => {
  135 |     // Navigate to the home page
  136 |     await page.goto('/');
  137 |     await page.waitForLoadState('domcontentloaded');
  138 |     const continueButton = page.getByRole('button', { name: 'Continue browsing' });
  139 |     const feedItems = page.locator('div.feed-item');
  140 |
  141 |     // Test infinite scroll with for loop
  142 |     for (let i = 0; i < 26; i += 2) {
  143 |       // scroll
  144 |       if (await feedItems.nth(i).isVisible()) {
  145 |         await feedItems.nth(i).scrollIntoViewIfNeeded();
  146 |         // Print author name
  147 |         // console.log(`${i}: ${await feedItems.nth(i).locator("a.base-username").first().textContent()}`);
  148 |       } else {
  149 |         await page.locator("div.v3-infinite-loading").scrollIntoViewIfNeeded();
  150 |         await page.waitForTimeout(1500);
  151 |       }
  152 |       // if continueButton is visible, click it
  153 |       if (await continueButton.isVisible()) {
  154 |         await continueButton.click();
  155 |       }
  156 |       await page.waitForTimeout(500);
  157 |     }
  158 |
  159 |     // moderation status strings should not be visible in the page
  160 |     await expect.soft(page.getByText("Someone in our team is checking your content...")).not.toBeVisible();
  161 |     await expect.soft(page.getByText("Rejected for having harmful content")).not.toBeVisible();
  162 |   });
  163 | });
  164 |
```